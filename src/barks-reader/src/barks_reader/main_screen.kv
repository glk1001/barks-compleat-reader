<BarButton@ActionButton>:
    mipmap: True
    draggable: False

# Helper function to create a checkbox row
<CheckBoxRow@BoxLayout>:
    orientation: 'horizontal'
    size_hint_y: None
    height: dp(20)
    spacing: dp(10)
    label_text: ""
    theme_enum: None  # property to hold the ImageThemes enum
    active: True
    CheckBox:
        size_hint_x: None
        width: dp(40)
        active: self.parent.active
        on_active:
            self.parent.active = self.active
            app._main_screen.on_checkbox_row_changed(self.parent)
    Label:
        text: self.parent.label_text
        bold: True
        text_size: self.size
        halign: 'left'
        valign: 'middle'


<BackgroundColor@Widget>
    background_color: (1, 1, 1, 1)
    sizing_factor_x: 1
    sizing_factor_y: 1
    canvas.before:
        Color:
            rgba: self.background_color
        Rectangle:
            size: self.sizing_factor_x * self.size[0], self.sizing_factor_y * self.size[1]
            pos:
                self.pos[0] - (0.5 * (self.sizing_factor_x - 1) * self.size[0]), \
                self.pos[1] - (0.5 * (self.sizing_factor_y - 1) * self.size[1])

<BgColorLabel@Label+BackgroundColor>
    background_color: (0, 0, 0, 0)

<LoadingDataPopup>:
    opacity: 0
    background_color: (1, 1, 0, 1)
    title: "Please wait.   Loading all the titles ..."
    title_size: fm.loading_title_size
    title_font: fm.loading_title_font_name
    title_align: "left"
    title_color: (1,1,0.4,1)
    separator_color: (1, 0, 0, 0.0)
    separator_height: dp(4)
    size_hint: (1, 0.55)
    x: 0
    y: 0
    auto_dismiss: False
    mipmap: True

    BoxLayout:
        orientation: "vertical"

        Image:
            color: (1,1,1,1)
            opacity: 1.0
            texture: root.splash_image_texture
            size_hint: (1, 0.9)
            fit_mode: "cover"
            mipmap: True

        Label:
            text: "vertical filler"
            color: (0,0,0,0)
            size_hint: (1, 0.02)

        ProgressBar:
            id: loading_data_progress_bar
            size_hint: (1, 0.05)
            value: root.progress_bar_value
            min: 0
            max: 3

<MessagePopup>:
    background_color: (0,0,1,1)
    title: "USER SUPPLIED"
    title_size: fm.loading_title_size
    title_font: fm.loading_title_font_name
    title_align: "center"
    title_color: (1, 0, 0, 1)
    auto_dismiss: False
    size_hint: 0.9, 0.5

    BoxLayout:
        orientation: "vertical"

        Label:
            text: root.msg_text
            font_size: fm.error_popup_font_size
            background_color: (1, 1, 1, 1)
            multiline: True
            markup: True
            size: self.texture_size
            halign: 'left'
            valign: 'middle'
            size_hint: 0.7, 0.9
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}

        BoxLayout:
            orientation: "horizontal"
            size_hint: 0.45, 0.20
            pos_hint: {'right': 1, 'top': 1}
            spacing: dp(10)
            padding: [dp(20),dp(20),dp(20),dp(20)]

            Button:
                disabled: not root.ok_text
                opacity: 0 if not root.ok_text else 1
                text: root.ok_text
                font_size: fm.error_popup_button_font_size
                text_size: self.size
                halign: 'center'
                valign: 'middle'
                bold: True
                on_press: root.ok()

            Button:
                text: root.cancel_text
                font_size: fm.error_popup_button_font_size
                text_size: self.size
                halign: 'center'
                valign: 'middle'
                on_press: root.cancel()

<MainScreen>:
    orientation: "vertical"

    ActionBar:
        id: action_bar
        size: root.width, root.ACTION_BAR_HEIGHT

        ActionView:
            use_separator: False

            ActionPrevious:
                title: root.app_title
                color: root.ACTION_BAR_TITLE_COLOR
                markup: True
                app_icon: root.app_icon_filepath
                mipmap: True
                with_previous: False

            ActionOverflow:

            ActionSeparator:

            BarButton:
                text: 'Quit'
                icon: root.action_bar_close_icon_filepath
                important: True
                on_release: app.close_app()

 #           BarButton:
 #               id: fullscreen_button
 #               text: "Fullscreen"
#                icon: root.action_bar_fullscreen_filepath
 #               important: True
#                on_press: root.comic_book_reader.toggle_fullscreen(self)

            BarButton:
                text: 'Collapse'
                icon: root.action_bar_collapse_icon_filepath
                on_release: root.on_action_bar_collapse()

            BarButton:
                text: 'Change Pics'
                icon: root.action_bar_change_pics_icon_filepath
                on_release: root.on_action_bar_change_view_images()

            BarButton:
                text: 'Settings'
                icon: root.action_bar_settings_icon_filepath
                on_release: app.open_settings(self)
